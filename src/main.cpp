#include <Arduino.h>

#include <BluetoothSerial.h>
#include <SSD1306Wire.h>
#include <HCSR04.h>

BluetoothSerial SerialBT;
SSD1306Wire display(0x3c, 19, 21);

static unsigned char logo_kassa_bits[] = {
        0xff, 0xff, 0xff, 0x01, 0x1f, 0xf0, 0x07, 0x01, 0x0f, 0xf0, 0x1f, 0x01,
        0x07, 0xf0, 0x3f, 0x01, 0x03, 0xf0, 0x3f, 0x01, 0x01, 0xec, 0x7f, 0x01,
        0x01, 0xef, 0xff, 0x01, 0x81, 0xe9, 0xff, 0x01, 0xc1, 0xe8, 0xff, 0x01,
        0x01, 0xe8, 0xff, 0x01, 0x01, 0xe8, 0xff, 0x01, 0x01, 0xe8, 0xff, 0x01,
        0x01, 0xe8, 0xff, 0x01, 0x01, 0xe8, 0xff, 0x01, 0x01, 0xe8, 0xff, 0x01,
        0x01, 0xe8, 0xff, 0x01, 0x01, 0xe8, 0xff, 0x01, 0x01, 0xe8, 0xff, 0x01,
        0x01, 0xcc, 0x7f, 0x01, 0x03, 0x8f, 0x7f, 0x01, 0x03, 0xf0, 0x3f, 0x01,
        0x07, 0xf0, 0x1f, 0x01, 0x1f, 0xf0, 0x0f, 0x01, 0x3f, 0xf0, 0x03, 0x01,
        0xff, 0xff, 0xff, 0x01};



byte triggerPin = 5;
byte echoCount = 1;
byte* echoPins = new byte[echoCount] {18};

double lees() {
    double distances = HCSR04.measureDistanceCm()[0];
    Serial.print(distances);
    Serial.print(" cm");
    Serial.println();
    return distances;
}

void setup() {
    display.init();
    display.clear();
    display.setFont(ArialMT_Plain_10);
    Serial.begin(9600);
    HCSR04.begin(triggerPin, echoPins, echoCount);
    SerialBT.begin("ESP32test"); //Bluetooth device name
    Serial.println("The device started, now you can pair it with bluetooth!");
}

void loop() {
    if (SerialBT.available()) {
        display.clear();
        display.drawXbm(103, 39, 25, 25, logo_kassa_bits);
        display.drawString(0, 0, SerialBT.readString());
        display.display();
    }
    delay(1000);
}